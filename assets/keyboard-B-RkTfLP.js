import{n as o,I as c}from"./index-DGvlKVSw.js";import{V as v}from"./vendor-C-Ryi81X.js";const _={name:"WordsHeader",props:{title:String}};var b=function(){var t=this,e=t._self._c;return e("div",{staticClass:"words-header"},[e("span",{staticClass:"book-title",on:{click:function(i){return t.$emit("change")}}},[t._v(" "+t._s(t.title||"词库")+" "),e("svg",{staticClass:"arrow",attrs:{width:"16",height:"16",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M6 10l6 6 6-6",stroke:"#3578e5","stroke-width":"2",fill:"none","stroke-linecap":"round"}})])])])},g=[],y=o(_,b,g,!1,null,"05f9bca7");const et=y.exports,w={name:"WordsProgress",props:{total:Number,current:Number},computed:{progressPercent(){let a=this.current/this.total||0;return Math.round(a*100)}}};var C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"progress-bar-fixed"},[e("div",{staticClass:"progress-bar-bg"},[e("div",{staticClass:"progress-bar-fg",style:{width:t.progressPercent+"%"}})]),e("div",{staticClass:"progress-text"},[t._v(" "+t._s(t.current)+" / "+t._s(t.total)+" ")])])},$=[],k=o(w,C,$,!1,null,"4487d368");const at=k.exports,I={name:"FinishModal",props:{visible:{type:Boolean,default:!1},bookName:{type:String,default:""},subtitle:{type:String,default:""},restartText:{type:String,default:"再来一轮"},homeText:{type:String,default:"休息一下"}}};var x=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"finish-mask",attrs:{"data-test":"finish-modal"}},[e("div",{staticClass:"finish-modal"},[e("div",{staticClass:"finish-title"},[t._v("🎉 恭喜你！")]),e("div",{staticClass:"finish-desc"},[t._v(t._s(t.subtitle||`本轮词库「${t.bookName}」已全部学完`))]),e("div",{staticClass:"finish-actions"},[t.restartText?e("button",{directives:[{name:"test",rawName:"v-test",value:"finish-btn",expression:"'finish-btn'"}],staticClass:"finish-btn",on:{click:function(i){return t.$emit("restart")}}},[t._v(" "+t._s(t.restartText||"再来一轮")+" ")]):t._e(),t.homeText?e("button",{directives:[{name:"test",rawName:"v-test",value:"home-btn",expression:"'home-btn'"}],staticClass:"finish-btn home-btn",on:{click:function(i){return t.$emit("returnHome")}}},[t._v(" "+t._s(t.homeText||"休息一下")+" ")]):t._e()])])]):t._e()},D=[],U=o(I,x,D,!1,null,"611326f5");const N=U.exports;let n=null;const it=(a={})=>(n&&n.$destroy(),new Promise(t=>{const e=v.extend(N);return n=new e({propsData:{visible:!0,bookName:a.bookName||"",subtitle:a.subtitle||"",restartText:a.restartText||"",homeText:a.homeText||""}}),n.$mount(),document.body.appendChild(n.$el),n.$on("restart",()=>{f(),t({success:!0,data:!0})}),n.$on("returnHome",()=>{f(),t({success:!0,data:!1})}),n})),f=()=>{n&&(n.visible=!1,setTimeout(()=>{n.$destroy(),n.$el.remove(),n=null},300))},T={name:"CardActions",components:{Icon:c},props:{showIframeBtn:{type:Boolean,default:!1}},methods:{handlePass(){this.$emit("pass")},handleFail(){this.$emit("fail")},handleIframe(){this.$emit("iframe")}}};var S=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card-actions"},[e("div",{directives:[{name:"test",rawName:"v-test",value:"pass-btn",expression:"'pass-btn'"}],staticClass:"action-btn pass-btn",attrs:{title:"已掌握"},on:{click:t.handlePass}},[e("Icon",{style:{color:"#4caf50"},attrs:{icon:"mdi:check",width:"28",height:"28"}})],1),e("div",{directives:[{name:"test",rawName:"v-test",value:"fail-btn",expression:"'fail-btn'"}],staticClass:"action-btn fail-btn",attrs:{title:"再看一次"},on:{click:t.handleFail}},[e("Icon",{style:{color:"#e55"},attrs:{icon:"mdi:close",width:"28",height:"28"}})],1)])},L=[],M=o(T,S,L,!1,null,"69fd0944");const st=M.exports,d={youdao:{name:"有道词典",nameEn:"Youdao Dictionary",url:"https://dict.youdao.com/result?word=",icon:"mdi:book-open-variant",color:"#1e88e5",description:"网易有道词典"},iciba:{name:"金山",nameEn:"iCIBA",url:"https://www.iciba.com/word?w=",icon:"mdi:book-open-variant",color:"#1976d2",description:"金山在线词典"},baidu:{name:"百度翻译",nameEn:"Baidu Translate",url:"https://fanyi.baidu.com/#en/zh/",icon:"mdi:book-open-variant",color:"#388e3c",description:"百度翻译词典"},sogou:{name:"搜狗",nameEn:"Sogou Translate",url:"https://fanyi.sogou.com/text?keyword=",icon:"mdi:book-open-variant",color:"#7b1fa2",description:"搜狗词典"},tencent:{name:"腾讯翻译",nameEn:"Tencent Translate",url:"https://fanyi.qq.com/translate?source=auto&target=zh&text=",icon:"mdi:book-open-variant",color:"#ff6f00",description:"腾讯翻译词典"},bing:{name:"必应词典",nameEn:"Bing Dictionary",url:"https://cn.bing.com/dict/search?q=",icon:"mdi:book-open-variant",color:"#c2185b",description:"微软必应词典"},dictcn:{name:"海词词典",nameEn:"Dict.cn",url:"https://dict.cn/",icon:"mdi:book-open-variant",color:"#d32f2f",description:"海词在线词典"},aiciba:{name:"爱词霸",nameEn:"AiCIBA",url:"https://www.aiciba.com/word?w=",icon:"mdi:book-open-variant",color:"#f57c00",description:"爱词霸在线词典"},cambridge:{name:"剑桥词典",nameEn:"Cambridge Dictionary",url:"https://dictionary.cambridge.org/dictionary/english/",icon:"mdi:book-open-variant",color:"#1e88e5",description:"剑桥大学权威英语词典",mayFail:!0,requiresVPN:!0},merriam:{name:"韦氏词典",nameEn:"Merriam-Webster",url:"https://www.merriam-webster.com/dictionary/",icon:"mdi:book-open-variant",color:"#388e3c",description:"美国韦氏词典",mayFail:!0,requiresVPN:!0}};function E(a,t){const e=d[a];if(!e)throw new Error(`未知的词典类型: ${a}`);return e.url+encodeURIComponent(t)}function l(a){const t=d[a];return t?t.name:"未知词典"}function F(a){const t=d[a];return t?t.icon:"mdi:book-open-variant"}function R(){return["iciba","sogou"]}const P={name:"IframeModal",components:{Icon:c},props:{visible:{type:Boolean,default:!1},url:{type:String,default:""},title:{type:String,default:""},showRefresh:{type:Boolean,default:!0},showUrlInput:{type:Boolean,default:!0},width:{type:String,default:"100vw"},height:{type:String,default:"100vh"},closeOnOverlay:{type:Boolean,default:!0}},data(){return{currentUrl:"",urlInput:"",loading:!1,loadTimeout:null,loadStartTime:null,loadDuration:0}},computed:{containerStyle(){return{maxWidth:this.width,maxHeight:this.height}}},watch:{visible(a){a?this.initModal():this.resetModal()},url:{immediate:!0,handler(a){a&&this.visible&&this.loadUrlFromProp(a)}}},methods:{initModal(){this.url&&this.loadUrlFromProp(this.url),document.body.style.overflow="hidden"},resetModal(){this.currentUrl="",this.urlInput="",this.loading=!1,this.clearLoadTimeout(),this.loadStartTime=null,this.loadDuration=0,document.body.style.overflow=""},loadUrlFromProp(a){this.currentUrl=a,this.urlInput=a,this.startLoading()},loadUrl(){const a=this.urlInput.trim();if(a){if(!this.isValidUrl(a)){this.$emit("error",{message:"请输入有效的网址"});return}this.currentUrl=a,this.startLoading(),this.$emit("url-change",a)}},refreshIframe(){if(this.currentUrl){this.startLoading();const a=this.$refs.iframeRef;a&&(a.src=this.currentUrl)}},startLoading(){this.loading=!0,this.loadStartTime=Date.now(),this.clearLoadTimeout(),this.loadTimeout=setTimeout(()=>{this.loading=!1,this.$emit("error",{message:"加载超时，请检查网络连接"})},3e4)},clearLoadTimeout(){this.loadTimeout&&(clearTimeout(this.loadTimeout),this.loadTimeout=null)},onIframeLoad(){this.loading=!1,this.clearLoadTimeout(),this.loadDuration=Date.now()-this.loadStartTime,this.$emit("loaded",this.currentUrl)},onIframeError(){this.loading=!1,this.clearLoadTimeout(),this.$emit("error",{message:"页面加载失败，请检查网址是否正确"})},closeModal(){this.$emit("update:visible",!1),this.$emit("close")},handleOverlayClick(){this.closeOnOverlay&&this.closeModal()},isValidUrl(a){try{return new URL(a),!0}catch{return!1}},getDisplayUrl(a){try{const t=new URL(a);return t.hostname+t.pathname}catch{return a}},cancelLoading(){this.loading=!1,this.clearLoadTimeout(),this.loadDuration=Date.now()-this.loadStartTime,console.log(`加载已取消，耗时: ${this.loadDuration}ms`),this.$emit("error",{message:"加载已取消"})}},beforeDestroy(){this.clearLoadTimeout(),document.body.style.overflow=""}};var B=function(){var t=this,e=t._self._c;return e("Transition",{attrs:{name:"modal-fade"}},[t.visible?e("div",{directives:[{name:"test",rawName:"v-test",value:"iframe-modal-overlay",expression:"'iframe-modal-overlay'"}],staticClass:"iframe-modal-overlay",on:{click:t.handleOverlayClick}},[e("div",{directives:[{name:"test",rawName:"v-test"}],staticClass:"iframe-modal-container",style:t.containerStyle,on:{click:function(i){i.stopPropagation()}}},[t.loading?e("div",{staticClass:"iframe-loading-overlay"},[e("div",{staticClass:"loading-spinner"},[e("Icon",{staticClass:"spinning",attrs:{icon:"mdi:loading",width:"32",height:"32"}}),e("div",{staticClass:"loading-text"},[t._v("正在加载词典内容...")]),e("div",{staticClass:"loading-progress"},[e("div",{staticClass:"progress-bar"},[e("div",{staticClass:"progress-fill"})]),e("div",{staticClass:"progress-text"},[t._v("请稍候，这可能需要几秒钟")])]),e("button",{directives:[{name:"test",rawName:"v-test",value:"cancel-load-btn",expression:"'cancel-load-btn'"}],staticClass:"cancel-load-btn",attrs:{title:"取消加载"},on:{click:t.cancelLoading}},[e("Icon",{attrs:{icon:"mdi:close",width:"16",height:"16"}}),e("span",[t._v("取消加载")])],1)],1)]):t._e(),e("div",{staticClass:"iframe-container"},[t.currentUrl?e("iframe",{ref:"iframeRef",style:{opacity:t.loading?.3:1},attrs:{src:t.currentUrl,frameborder:"0",allowfullscreen:""},on:{load:t.onIframeLoad,error:t.onIframeError}}):e("div",{staticClass:"iframe-placeholder"},[e("Icon",{attrs:{icon:"mdi:web",width:"48",height:"48"}}),e("div",{staticClass:"placeholder-text"},[t._v("请输入要加载的网址")])],1)]),t.showUrlInput?e("div",{staticClass:"iframe-modal-footer"},[e("div",{staticClass:"url-input-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.urlInput,expression:"urlInput"}],staticClass:"url-input",attrs:{type:"url",placeholder:"请输入网址 (例如: https://example.com)"},domProps:{value:t.urlInput},on:{keyup:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.loadUrl.apply(null,arguments)},input:function(i){i.target.composing||(t.urlInput=i.target.value)}}}),e("button",{directives:[{name:"test",rawName:"v-test",value:"load-btn",expression:"'load-btn'"}],staticClass:"load-btn",attrs:{disabled:!t.urlInput.trim()},on:{click:t.loadUrl}},[t._v(" 加载 ")])])]):t._e(),e("div",{staticClass:"iframe-modal-header"},[e("div",{staticClass:"iframe-modal-title"},[t.title?e("span",[t._v(t._s(t.title))]):t.currentUrl?e("span",{staticClass:"url-display"},[t._v(t._s(t.getDisplayUrl(t.currentUrl)))]):t._e()]),e("div",{staticClass:"iframe-modal-actions"},[t.showRefresh?e("button",{directives:[{name:"test",rawName:"v-test",value:"refresh-btn",expression:"'refresh-btn'"}],staticClass:"action-btn refresh-btn",attrs:{title:"刷新页面"},on:{click:t.refreshIframe}},[e("Icon",{attrs:{icon:"mdi:refresh",width:"20",height:"20"}})],1):t._e(),e("button",{directives:[{name:"test",rawName:"v-test",value:"close-btn",expression:"'close-btn'"}],staticClass:"action-btn close-btn",attrs:{title:"关闭"},on:{click:t.closeModal}},[e("Icon",{attrs:{icon:"mdi:close",width:"20",height:"20"}})],1)])])])]):t._e()])},O=[],A=o(P,B,O,!1,null,"c584f4eb");const H=A.exports;class W{constructor(){this.instance=null,this.container=null}open(t={}){return new Promise(e=>{this.instance&&this.close(),this.container=document.createElement("div"),document.body.appendChild(this.container);const i=v.extend(H);this.instance=new i({propsData:{visible:!0,url:t.url||"",title:t.title||"",showRefresh:t.showRefresh!==!1,showUrlInput:t.showUrlInput!==!1,width:t.width||"100vw",height:t.height||"100vh",closeOnOverlay:t.closeOnOverlay!==!1}}),this.instance.$on("loaded",t.onLoaded),this.instance.$on("error",t.onError),this.instance.$on("url-change",t.onUrlChange),this.instance.$on("close",()=>{this.close(),e()}),this.instance.$on("update:visible",s=>{s||(this.close(),e())}),this.instance.$mount(this.container)})}close(){this.instance&&(document.body.removeChild(this.instance.$el),this.instance.$destroy(),this.instance=null)}isOpen(){return!!this.instance}}const q=new W,V=a=>q.open(a),z={name:"DictionaryLinks",components:{Icon:c},props:{word:{type:String,required:!0}},computed:{dictionaries(){return R()}},methods:{getDictionaryName(a){return l(a)},getDictionaryIcon(a){return F(a)},handleDictionaryClick(a){this.openDictionary(a,this.word)},async openDictionary(a,t){if(t)try{const e=E(a,t),i=l(a),s=`${i} - ${t}`;await V({url:e,title:s,showRefresh:!0,showUrlInput:!1,width:"100vw",height:"80vh",onLoaded:()=>{},onError:r=>{r.message.includes("frame-ancestors")||r.message.includes("CSP")?alert(a==="cambridge"||a==="merriam"?`${i}不支持在iframe中显示。

建议：
1. 尝试其他国内词典
2. 或直接访问：${e}`:`${i}不支持在iframe中显示，请尝试其他词典。`):r.message.includes("加载已取消")||alert(`${i}加载失败: ${r.message}`)}})}catch(e){alert(`打开${l(a)}失败: ${e.message}`)}}}};var X=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dictionary-links"},[e("div",{staticClass:"dictionary-title"},[t._v("权威词典")]),e("div",{staticClass:"dictionary-buttons"},t._l(t.dictionaries,function(i){return e("button",{directives:[{name:"test",rawName:"v-test",value:"dict-btn-"+i,expression:"'dict-btn-' + dictType"}],key:i,staticClass:"dict-btn",attrs:{title:t.getDictionaryName(i)},on:{click:function(s){return t.handleDictionaryClick(i)}}},[e("Icon",{attrs:{icon:t.getDictionaryIcon(i),width:"14",height:"14"}}),e("span",{staticClass:"dict-btn-text"},[t._v(t._s(t.getDictionaryName(i)))])],1)}),0)])},j=[],K=o(z,X,j,!1,null,"e6aea17d");const nt=K.exports,Y={name:"SliderContainer",props:{items:{type:Array,required:!0},isAnimating:{type:Boolean,default:!1},deltaX:{type:Number,default:0}},methods:{getItemStyle(a){const t=(a-1)*100,e=this.deltaX/window.innerWidth*100;return{transform:`translateX(calc(${t}% + ${e}vw))`,transition:this.isAnimating?"transform 0.3s cubic-bezier(0.25, 0.8, 0.5, 1)":"none",zIndex:a===1?2:1,opacity:a===1?1:.5}}}};var G=function(){var t=this,e=t._self._c;return e("div",{staticClass:"slider-container"},t._l(t.items,function(i,s){return e("div",{key:s,staticClass:"slider-item",class:{"is-current":s===1},style:t.getItemStyle(s)},[t._t("default",null,{item:i,index:s})],2)}),0)},J=[],Q=o(Y,G,J,!1,null,"782c2f8a");const rt=Q.exports,ot={bind(a,t,e){const i=e.context,{value:s}=t,r=m=>{if(!s)return;const p=Array.isArray(s)?s:[s];for(const{key:u,handler:h}of p)if(u&&h&&m.key===u){m.preventDefault(),h.call(i);break}};a._keyboardHandler=r,window.addEventListener("keydown",r)},unbind(a){window.removeEventListener("keydown",a._keyboardHandler),delete a._keyboardHandler}};export{st as C,nt as D,rt as S,at as W,et as a,ot as k,it as o};
