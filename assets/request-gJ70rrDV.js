import{t as i,p as u}from"./index-DGvlKVSw.js";import{$ as n}from"./toast-CB_qA10t.js";function c(e){const t=new Date;t.setDate(t.getDate()+7),localStorage.setItem("token",e),document.cookie=`token=${e}; expires=${t.toUTCString()}; path=/; secure; samesite=strict`}function l(){var e,t,s,o;return localStorage.getItem("token")||((o=(s=(t=(e=document.cookie)==null?void 0:e.split("; "))==null?void 0:t.find(a=>a.startsWith("token=")))==null?void 0:s.split("="))==null?void 0:o[1])||null}let r=i();r.defaults.baseURL=void 0;r.defaults.timeout=6e4;r.defaults.withCredentials=!0;r.interceptors.request.use(e=>{let t=l();return t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer "+t),e});r.interceptors.response.use(e=>e&&e.data&&e.data.rt===401?(u.push("/login"),n.error("登录过期，请重新登录"),Promise.reject({isCustom401:!0,response:e})):e);export{r,c as s};
