import{t as n,p as o}from"./index-_H_dCgnf.js";import{$ as i}from"./toast-CjpLh0RV.js";function c(t){const e=new Date;e.setDate(e.getDate()+7),localStorage.setItem("token",t),document.cookie=`token=${t}; expires=${e.toUTCString()}; path=/; secure; samesite=strict`}function m(){var t,e,s,a;return localStorage.getItem("token")||((a=(s=(e=(t=document.cookie)==null?void 0:t.split("; "))==null?void 0:e.find(u=>u.startsWith("token=")))==null?void 0:s.split("="))==null?void 0:a[1])||null}let r=n();r.defaults.baseURL=void 0;r.defaults.timeout=6e4;r.defaults.withCredentials=!0;r.interceptors.request.use(t=>{let e=m();return e&&(t.headers=t.headers||{},t.headers.Authorization="Bearer "+e),t});r.interceptors.response.use(t=>t&&t.data&&t.data.rt===401?(o.push("/login"),i.error(t.data.msg||"请登录"),Promise.reject({isCustom401:!0,response:t})):t,t=>{let{response:e}=t;return e&&e.data&&e.data.rt===401?(o.push("/login"),i.error(e.data.msg||"请登录"),Promise.reject({isCustom401:!0,response:e})):Promise.reject(t)});export{r,c as s};
